<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>World Country Flags</title><meta charset="utf-8">
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript" src="../jquery/jquery-1.11.1.min.js"></script>
        <script type="text/javascript" src="../d3.v3/d3.v3.js" charset="utf-8"></script>
        <script type="text/javascript" src="../keshif.js" charset="utf-8"></script>
        <script type="text/javascript" src="../js/papaparse.min.js" charset="utf-8"></script>
        <link rel="stylesheet" href="../keshif.css"/ type="text/css">
        <link rel="stylesheet" href="../font-awesome/css/font-awesome.min.css">

        <script type="text/javascript" src="./js/demo.js" charset="utf-8"></script>
        <link rel="stylesheet" href="./css/style.css"/ type="text/css">

        <script type="text/javascript" src="js/modernizr.js" charset="utf-8"></script>
        <script type="text/javascript" src="js/log.js" charset="utf-8"></script>

        <script type="text/javascript" src="./js/moment.min.js" charset="utf-8"></script>

        <script type="text/javascript">

var demoID = 12;

function landmassText(d){
    switch(d){
        case 1: return "North America";
        case 2: return "South America";
        case 3: return "Europe";
        case 4: return "Africa";
        case 5: return "Asia";
        case 6: return "Oceania";
        default: return "-";
    }
};

function zoneText(d){
    switch(d){
        case 1: return "North East";
        case 2: return "South East";
        case 3: return "South West";
        case 4: return "North West";
        default: return "-";
    }
};

function languageText(d){
    switch(d){
        case 1: return "English";
        case 2: return "Spanish";
        case 3: return "French";
        case 4: return "German";
        case 5: return "Slavic";
        case 6: return "Other Indo-European";
        case 7: return "Chinese";
        case 8: return "Arabic";
        case 9: return "Others";
        case 10: return "Others";
        case 11: return "Portuguese"
        default: return "-";
    }
};

function religionText(d){
    switch(d){
        case 0: return "Catholic";
        case 1: return "Other Christian";
        case 2: return "Muslim";
        case 3: return "Buddhist";
        case 4: return "Hindu";
        case 5: return "Ethnic";
        case 6: return "Diverse";
        case 7: return "Others";
        default: return "-";
    }
};

var flag_cols = {
    Country : 0,
    Was:1,
    Independence:2,
    Flag:3,
    Landmass:4,
    Zone:5,
    Area:6,
    Population:7,
    Language:8,
    Religion:9,
    Bars:10,
    Stripes:11,
    Colors:12,
    Red:13,
    Green:14,
    Blue:15,
    Gold:16,
    White:17,
    Black:18,
    Orange:19,
    Mainhue:20,
    Circles:21,
    Crosses:22,
    Saltires:23,
    Quarters:24,
    Sunstars:25,
    Crescent:26,
    Triangle:27,
    Icon:28,
    Animate:29,
    Text:30
};


$(document).ready( function() {

    logIf.Check = logIf.All();

    browser = new kshf.Browser({
        domID : "#chart_div",
        categoryTextWidth: 155,
        source : {
            dirPath: 'data/',
            fileType: 'csv',
            sheets : [ {name:"flags", id:'Country'} ]
        },
/*        source : {
            gdocId : '0Ai6LdDWgaqgNdHRpMDlwUTlZc0NqNHJjc1VEeXV3MEE',
            sheets : [ {name:"Flags"} ]
        },*/
        facets: [
            {
                facetTitle: "Continent",
                catLabelText: function(d) { return landmassText(d.data[1]); },
                sortingOpts : [
                    { name:"Flag #" },
                    { name: "First Flag",  func: kshf.Util.sortFunc_Time_First }
                ],
                timeTitle: "Flag Date",
                timeItemMap : function(flag){  return new Date(moment(flag.data.Independence,"MM/DD/YYYY")); },
                timeBarShow: true,
                textFilter : 'in', textGroup  : 'continents'
            },{
                facetTitle: "Language",
                catItemMap : function(flag){
                    var r= flag.data.Language;
                    if(r===9) return 10;
                    return r;
                },
                catLabelText: function(d) { return languageText(d.data[1]); }
            },
            /*
            {
                facetTitle: "Zone",
                catItemMap : function(flag){return flag.data[flag_cols.Zone]; },
                catLabelText: function(d) { return zoneText(d.data[1]); },
                collapsed: true,
                filter: { rowConj: 'zone' }
            },{
                facetTitle: "Religion",
                catItemMap : function(flag){return flag.data[flag_cols.Religion]; },
                catLabelText: function(d) { return religionText(d.data[1]); },
                collapsed: true,
                filter: { rowConj: 'religion' }
            }); */
            {
                facetTitle: "Color",
                catItemMap : function(flag){
                    var toRet = [];
                    if(flag.data.Red) toRet.push("Red");
                    if(flag.data.Green) toRet.push("Green");
                    if(flag.data.Blue) toRet.push("Blue");
                    if(flag.data.Gold) toRet.push("Gold / Yellow");
                    if(flag.data.White) toRet.push("White");
                    if(flag.data.Black) toRet.push("Black");
                    if(flag.data.Orange) toRet.push("Orange / Brown");
                    return toRet;
                },
                textFilter : 'has color', textGroup  : 'colors'
            },{
                facetTitle: "Shape",
                catItemMap : function(flag){
                    var toRet = [];
                    if(flag.data.Circles) toRet.push("Circle");
                    if(flag.data.Crosses) toRet.push("Crosses");
                    if(flag.data.Saltires) toRet.push("Saltire");
                    if(flag.data.Quarters) toRet.push("Quarter");
                    if(flag.data.Sunstars) toRet.push("Sun / star");
                    if(flag.data.Crescent) toRet.push("Crescent");
                    if(flag.data.Triangle) toRet.push("Triangle");
                    return toRet;
                },
                textFilter : 'has shape', textGroup  : 'shapes'
            }, {
                facetTitle: "# of Bars",
                catItemMap : function(flag){ 
                    var r=flag.data.Bars;
                    return (r===0)?0:r;
                }
            },{
                facetTitle: "# of Stripes",
                catItemMap : function(flag){ 
                    var r=flag.data.Stripes;
                    return (r===0)?null:r;
                }
            } /*,{
                facetTitle: "Other Properties",
                catItemMap : function(flag){
                    var toRet = [];
                    if(flag.data.Text!==0) toRet.push("Text");
                    if(flag.data.Icon!==0) toRet.push("Icon");
                    if(flag.data.Animate!==0) toRet.push("Animate");
                    return toRet;
                },
                filter: {
                    rowConj: 'with property'
                }
            });*/
        ],
        readyCb: function(){
            $(".countryName").click(function(d){
                var kshfItem = d.currentTarget.parentNode.__data__;
                browser.showListItemDetails(kshfItem);
            });
        },
        itemDisplay: {
            sortColWidth: 60,
            sortingOpts : [
                {   name: 'Flag Date',
                    value: function(d){ 
                        var r= d.data.Independence;
                        if(r===null) return null;
                        var dt=new Date(moment(r,"MM/DD/YYYY"));
                        return dt.getUTCFullYear();
                    }
                }
            ],
            textSearch : "Country",
            detailsToggle : "Multi",
            detailsDefault : false,
            contentFunc : function(d){
                var j;
                var str="";
                // description
                    str+="<img src=\""+d.data.Flag+"\" width=\"120\" style=\"float:right\" class=\"item_details\">";
                    str+="<span class=\"iteminfo iteminfo_0 countryName\">";
                    str+=d.data.Country;
                    str+="</span></br>";
                    str+="<span class=\"item_details\">";
                    str+="<span class=\"iteminfo iteminfo_1\"><u>Continent</u>: ";
                    str+=landmassText(d.data.Landmass) + " | <u>Language</u>: ";
                    str+=languageText(d.data.Language);
    //                str+=" | <u>Religion</u>:"+religionText(d.data.Religion);
                    str+="</span></br>";
                    str+="<span class=\"iteminfo iteminfo_2\"> <u>Colors</u>: ";
                    if(d.data.Red) str+="Red, ";
                    if(d.data.Green) str+="Green, ";
                    if(d.data.Blue) str+="Blue, ";
                    if(d.data.Gold) str+="Gold / Yellow  , ";
                    if(d.data.White) str+="White, ";
                    if(d.data.Black) str+="Black, ";
                    if(d.data.Orange) str+="Orange / Brown, ";
                    str+="</span></br>";
                    str+="<span class=\"iteminfo iteminfo_2\"> <u>Shapes</u>: ";
                    if(d.data.Circles) str+="Circles, ";
                    if(d.data.Crosses) str+="Crosses, ";
                    if(d.data.Saltires) str+="Saltires, ";
                    if(d.data.Quarters) str+="Quarters, ";
                    if(d.data.Sunstars) str+="Sun / stars, ";
                    if(d.data.Crescent) str+="Crescent, ";
                    if(d.data.Triangle) str+="Triangle, ";
                    str+="</span></br>";
                    str+="</span>"; // item_details
                return str;
            }
        }
    });
});
        </script>
        <style>
            div.listItem{
                padding-bottom: 4px;
            }
            .iteminfo a{
                color:#606060;
                font-style:italic;
            }
            #chart_div {
                width:950px;
                height:700px;
            }
            .listItem[details=false] .countryName:hover{
                text-decoration: underline;
                color: rgb(151, 64, 43) !important;
                cursor: pointer;
            }
        </style>
	</head>
    <body onmousemove="logIf.setSessionID()">
        <div class="contents"><div id="chart_div"></div></div>
    </body>
</html>